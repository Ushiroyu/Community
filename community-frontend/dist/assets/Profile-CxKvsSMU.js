import{j as x,a as Y,w as J,b as ee,h as oe,u as se}from"./index-BRtYqat6.js";import{b as le,c as ae,e as Q,d as te,a as re,u as ie}from"./el-overlay-DoVcdlOL.js";import{E as ne,a as de}from"./el-form-item-DFokbjd4.js";import{b as B,C as ue,a as me,d as fe,_ as pe,E as ce}from"./_plugin-vue_export-helper-BH_is9DS.js";/* empty css                 */import{E as ge,a as ve}from"./el-descriptions-item-DmnZKFQu.js";/* empty css               */import{u as ye}from"./users-DXWfoKsj.js";import{a as be}from"./leader-BM-s6ogo.js";import{E as Ce}from"./index-B89e1ymx.js";import{d as T,i as O,b as D,c as A,o as v,a as f,R as N,A as w,V as g,u as e,Q as $,E as l,D as s,B as U,Y as _e,X as M,a4 as ke,r as L,a5 as Ee,a3 as j,U as we,a1 as he,a6 as $e,z as De,K as q,P as c}from"./vendor-vue-CpX8Jn4o.js";import{E as Ie,u as Pe}from"./index-DIxbWGny.js";import{F as Ve,E as Re}from"./focus-trap-P_RRA6FG.js";import{E as Se}from"./index-CkCNIzEM.js";import{u as Ae}from"./index-D8up7KiO.js";import{c as Te}from"./refs-BNlZ5koy.js";import{E as Fe}from"./index-C9h3pgbl.js";import{E}from"./http-y0YsLSxU.js";import"./castArray-esTnwj7j.js";import"./_Uint8Array-CSQzEANR.js";import"./_initCloneObject-CQpWRfh0.js";import"./vendor-icons-CDwfVtjd.js";import"./vnode-D67uqoy8.js";import"./scroll-C14GUqjp.js";import"./typescript-Bp3YSIOJ.js";const Ne=T({name:"ElDialogContent"}),Le=T({...Ne,props:ae,emits:le,setup(I,{expose:i}){const r=I,{t:y}=x(),{Close:u}=ue,{dialogRef:a,headerRef:P,bodyId:h,ns:n,style:m}=O(Q),{focusTrapRef:o}=O(Ve),V=Te(o,a),b=D(()=>!!r.draggable),R=D(()=>!!r.overflow),{resetPosition:F,updatePosition:_,isDragging:C}=Ae(a,P,b,R),k=D(()=>[n.b(),n.is("fullscreen",r.fullscreen),n.is("draggable",b.value),n.is("dragging",C.value),n.is("align-center",!!r.alignCenter),{[n.m("center")]:r.center}]);return i({resetPosition:F,updatePosition:_}),(d,S)=>(v(),A("div",{ref:e(V),class:g(e(k)),style:M(e(m)),tabindex:"-1"},[f("header",{ref_key:"headerRef",ref:P,class:g([e(n).e("header"),d.headerClass,{"show-close":d.showClose}])},[w(d.$slots,"header",{},()=>[f("span",{role:"heading","aria-level":d.ariaLevel,class:g(e(n).e("title"))},$(d.title),11,["aria-level"])]),d.showClose?(v(),A("button",{key:0,"aria-label":e(y)("el.dialog.close"),class:g(e(n).e("headerbtn")),type:"button",onClick:p=>d.$emit("close")},[l(e(me),{class:g(e(n).e("close"))},{default:s(()=>[(v(),U(_e(d.closeIcon||e(u))))]),_:1},8,["class"])],10,["aria-label","onClick"])):N("v-if",!0)],2),f("div",{id:e(h),class:g([e(n).e("body"),d.bodyClass])},[w(d.$slots,"default")],10,["id"]),d.$slots.footer?(v(),A("footer",{key:0,class:g([e(n).e("footer"),d.footerClass])},[w(d.$slots,"footer")],2)):N("v-if",!0)],6))}});var Ue=B(Le,[["__file","dialog-content.vue"]]);const ze=T({name:"ElDialog",inheritAttrs:!1}),Be=T({...ze,props:re,emits:te,setup(I,{expose:i}){const r=I,y=ke();fe({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},D(()=>!!y.title));const u=Y("dialog"),a=L(),P=L(),h=L(),{visible:n,titleId:m,bodyId:o,style:V,overlayDialogStyle:b,rendered:R,transitionConfig:F,zIndex:_,_draggable:C,_alignCenter:k,_overflow:d,handleClose:S,onModalClick:p,onOpenAutoFocus:X,onCloseAutoFocus:G,onCloseRequested:H,onFocusoutPrevented:W}=ie(r,a);De(Q,{dialogRef:a,headerRef:P,bodyId:o,ns:u,rendered:R,style:V});const z=Pe(p),Z=D(()=>r.modalPenetrable&&!r.modal&&!r.fullscreen);return i({visible:n,dialogContentRef:h,resetPosition:()=>{var t;(t=h.value)==null||t.resetPosition()},handleClose:S}),(t,eo)=>(v(),U(e(Se),{to:t.appendTo,disabled:t.appendTo!=="body"?!1:!t.appendToBody},{default:s(()=>[l(Ee,j(e(F),{persisted:""}),{default:s(()=>{var K;return[we(l(e(Ie),{"custom-mask-event":"",mask:t.modal,"overlay-class":[(K=t.modalClass)!=null?K:"",`${e(u).namespace.value}-modal-dialog`,e(u).is("penetrable",e(Z))],"z-index":e(_)},{default:s(()=>[f("div",{role:"dialog","aria-modal":"true","aria-label":t.title||void 0,"aria-labelledby":t.title?void 0:e(m),"aria-describedby":e(o),class:g(`${e(u).namespace.value}-overlay-dialog`),style:M(e(b)),onClick:e(z).onClick,onMousedown:e(z).onMousedown,onMouseup:e(z).onMouseup},[l(e(Re),{loop:"",trapped:e(n),"focus-start-el":"container",onFocusAfterTrapped:e(X),onFocusAfterReleased:e(G),onFocusoutPrevented:e(W),onReleaseRequested:e(H)},{default:s(()=>[e(R)?(v(),U(Ue,j({key:0,ref_key:"dialogContentRef",ref:h},t.$attrs,{center:t.center,"align-center":e(k),"close-icon":t.closeIcon,draggable:e(C),overflow:e(d),fullscreen:t.fullscreen,"header-class":t.headerClass,"body-class":t.bodyClass,"footer-class":t.footerClass,"show-close":t.showClose,title:t.title,"aria-level":t.headerAriaLevel,onClose:e(S)}),he({header:s(()=>[t.$slots.title?w(t.$slots,"title",{key:1}):w(t.$slots,"header",{key:0,close:e(S),titleId:e(m),titleClass:e(u).e("title")})]),default:s(()=>[w(t.$slots,"default")]),_:2},[t.$slots.footer?{name:"footer",fn:s(()=>[w(t.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","header-class","body-class","footer-class","show-close","title","aria-level","onClose"])):N("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[$e,e(n)]])]}),_:3},16)]),_:3},8,["to","disabled"]))}});var Me=B(Be,[["__file","dialog.vue"]]);const Ke=J(Me),Oe=ee({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:oe(String),default:"solid"}}),je=T({name:"ElDivider"}),qe=T({...je,props:Oe,setup(I){const i=I,r=Y("divider"),y=D(()=>r.cssVar({"border-style":i.borderStyle}));return(u,a)=>(v(),A("div",{class:g([e(r).b(),e(r).m(u.direction)]),style:M(e(y)),role:"separator"},[u.$slots.default&&u.direction!=="vertical"?(v(),A("div",{key:0,class:g([e(r).e("text"),e(r).is(u.contentPosition)])},[w(u.$slots,"default")],2)):N("v-if",!0)],6))}});var Ye=B(qe,[["__file","divider.vue"]]);const Je=J(Ye),Qe={class:"page-wrap profile-view"},Xe={class:"page-card profile-card","aria-labelledby":"profile-info-title",role:"region"},Ge={class:"page-section-title"},He={class:"page-card leader-card","aria-labelledby":"profile-role-title",role:"region","aria-describedby":"profile-role-desc"},We={class:"page-section-title"},Ze={__name:"Profile",setup(I){const i=se(),r=q({nickname:i.username||""}),y=L(!1),u=D(()=>i.isAdmin?"管理员":i.isSupplier?"供应商":i.isLeader?"社区团长":"社区居民"),a=q({visible:!1,loading:!1,form:{communityName:"",communityAddress:"",remark:""}}),P=async()=>{if(!r.nickname){E.error("请填写昵称");return}y.value=!0;try{const m=await ye(i.userId,{nickname:r.nickname});m.code===0?(E.success("信息已更新"),i.username=r.nickname):E.error(m.msg||"更新失败")}catch(m){E.error(m.message||"更新失败")}finally{y.value=!1}},h=()=>{a.visible=!0},n=async()=>{if(!a.form.communityName||!a.form.communityAddress){E.error("请完善社区名称与地址");return}a.loading=!0;try{const m=await be(i.userId,a.form.communityName,a.form.communityAddress);m.code===0?(E.success("申请已提交，请等待平台审核"),a.visible=!1):E.error(m.msg||"申请失败")}catch(m){E.error(m.message||"申请失败")}finally{a.loading=!1}};return(m,o)=>{const V=Ce,b=ve,R=ge,F=Je,_=Fe,C=de,k=ce,d=ne,S=Ke;return v(),A("div",Qe,[f("section",Xe,[f("header",Ge,[o[6]||(o[6]=f("h1",{id:"profile-info-title"},"基础信息",-1)),l(V,{type:"info",effect:"plain"},{default:s(()=>[c("用户 ID："+$(e(i).userId),1)]),_:1})]),o[9]||(o[9]=f("p",{id:"profile-info-desc",class:"sr-only"}," 包含账号身份信息与更新时间，仅平台内部可见。 ",-1)),l(R,{column:2,border:""},{default:s(()=>[l(b,{label:"用户名"},{default:s(()=>[c($(e(i).username||"未设置"),1)]),_:1}),l(b,{label:"角色"},{default:s(()=>[c($(u.value),1)]),_:1}),l(b,{label:"手机号"},{default:s(()=>[c($(e(i).phone||"暂无"),1)]),_:1}),l(b,{label:"注册时间"},{default:s(()=>[c($(e(i).createdAt||"暂无"),1)]),_:1})]),_:1}),l(F),l(d,{model:r,"label-width":"100px",class:"profile-form"},{default:s(()=>[o[8]||(o[8]=f("p",{id:"profile-edit-tip",class:"sr-only"}," 修改昵称后将同步到导航栏与订单信息中。 ",-1)),l(C,{label:"昵称"},{default:s(()=>[l(_,{modelValue:r.nickname,"onUpdate:modelValue":o[0]||(o[0]=p=>r.nickname=p),placeholder:"更新昵称后将同步账号显示名称","aria-describedby":"profile-edit-tip"},null,8,["modelValue"])]),_:1}),l(C,null,{default:s(()=>[l(k,{type:"primary",loading:y.value,onClick:P},{default:s(()=>[...o[7]||(o[7]=[c(" 保存信息 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),f("section",He,[f("header",We,[o[11]||(o[11]=f("h2",{id:"profile-role-title"},"角色拓展",-1)),e(i).isLeader?(v(),U(V,{key:0,type:"success",effect:"plain"},{default:s(()=>[...o[10]||(o[10]=[c("已是团长",-1)])]),_:1})):N("",!0)]),o[12]||(o[12]=f("p",{class:"muted"}," 团长可管理社区成员订单、协助商品分发与售后处理，促进社区高效运作。 ",-1)),o[13]||(o[13]=f("p",{id:"profile-role-desc",class:"sr-only"}," 申请成为团长后将进入平台审核，审核通过可管理所在社区订单。 ",-1)),l(k,{type:"success",onClick:h,disabled:e(i).isLeader},{default:s(()=>[c($(e(i).isLeader?"已成为团长":"申请成为团长"),1)]),_:1},8,["disabled"])]),l(S,{modelValue:a.visible,"onUpdate:modelValue":o[5]||(o[5]=p=>a.visible=p),title:"团长申请",width:"460px"},{footer:s(()=>[l(k,{onClick:o[4]||(o[4]=p=>a.visible=!1)},{default:s(()=>[...o[14]||(o[14]=[c("取消",-1)])]),_:1}),l(k,{type:"primary",loading:a.loading,onClick:n},{default:s(()=>[...o[15]||(o[15]=[c(" 提交申请 ",-1)])]),_:1},8,["loading"])]),default:s(()=>[l(d,{model:a.form,"label-width":"90px"},{default:s(()=>[l(C,{label:"社区名称"},{default:s(()=>[l(_,{modelValue:a.form.communityName,"onUpdate:modelValue":o[1]||(o[1]=p=>a.form.communityName=p)},null,8,["modelValue"])]),_:1}),l(C,{label:"社区地址"},{default:s(()=>[l(_,{modelValue:a.form.communityAddress,"onUpdate:modelValue":o[2]||(o[2]=p=>a.form.communityAddress=p)},null,8,["modelValue"])]),_:1}),l(C,{label:"备注"},{default:s(()=>[l(_,{modelValue:a.form.remark,"onUpdate:modelValue":o[3]||(o[3]=p=>a.form.remark=p),type:"textarea",rows:"2",placeholder:"说明社区规模、配送需求等信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Io=pe(Ze,[["__scopeId","data-v-1ac2d31e"]]);export{Io as default};
