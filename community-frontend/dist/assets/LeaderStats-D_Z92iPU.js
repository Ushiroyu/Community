import{u as I}from"./index-BRtYqat6.js";import{E as M,a as O}from"./el-descriptions-item-DmnZKFQu.js";import{E as N,a as C}from"./el-date-picker-panel-DVo8kLur.js";import{E as P}from"./el-skeleton-item-CblNMWFr.js";import{_ as L,E as U}from"./_plugin-vue_export-helper-BH_is9DS.js";/* empty css                 */import"./el-scrollbar-eEMXupeW.js";import{d as m}from"./vendor-utils-Bof1u0Bp.js";import{h as j,E as y}from"./http-y0YsLSxU.js";import{r as _,b as g,c as A,o as b,a as t,Q as s,E as l,D as o,B as E,P as n}from"./vendor-vue-CpX8Jn4o.js";import"./vnode-D67uqoy8.js";import"./index-C9h3pgbl.js";import"./vendor-icons-CDwfVtjd.js";import"./typescript-Bp3YSIOJ.js";import"./index-eOEDSGTO.js";import"./debounce-Bg3a7BCK.js";import"./index-BquL_2tb.js";import"./isEqual-BuOCdSDg.js";import"./_Uint8Array-CSQzEANR.js";import"./index-CkCNIzEM.js";import"./focus-trap-P_RRA6FG.js";const F={class:"page-wrap leader-stats"},G={class:"page-card stats-hero","aria-labelledby":"leader-stats-hero-title","aria-describedby":"leader-stats-hero-desc"},H={class:"sr-only"},Q={class:"hero-filter","aria-label":"筛选时间"},R={class:"page-card overview-card",role:"region","aria-labelledby":"leader-overview-title"},T={class:"page-card insight-grid"},q={class:"insight-card"},z={class:"insight-value"},J={class:"insight-card"},K={class:"insight-value"},W={class:"insight-card"},X={class:"insight-value"},Y={__name:"LeaderStats",setup(Z){const k=I(),u=_(!1),a=_({total:0,paid:0,shipped:0,delivered:0,gmv:0}),c=_([m().subtract(6,"day").startOf("day").toDate(),m().endOf("day").toDate()]),h=d=>(Number(d)||0).toFixed(2),w=g(()=>a.value.total?Math.round(a.value.paid/a.value.total*100):0),S=g(()=>a.value.total?h(a.value.gmv/a.value.total):"0.00"),D=g(()=>a.value.shipped?6:0),v=async()=>{var d;u.value=!0;try{const[e,p]=c.value||[],f={leaderId:k.userId,from:e?m(e).toISOString():void 0,to:p?m(p).toISOString():void 0},r=await j.get("/stats/leader-overview",{params:f});r.code===0?a.value=r.overview||((d=r.data)==null?void 0:d.overview)||a.value:y.error(r.msg||"统计数据加载失败")}catch(e){y.error(e.message||"统计异常")}finally{u.value=!1}};return v(),(d,e)=>{const p=N,f=U,r=P,i=O,V=C,x=M;return b(),A("div",F,[t("section",G,[t("div",null,[e[1]||(e[1]=t("span",{class:"pill"},"数据分析",-1)),e[2]||(e[2]=t("h1",{id:"leader-stats-hero-title",class:"hero-title"},"洞察社区订单趋势",-1)),e[3]||(e[3]=t("p",{id:"leader-stats-hero-desc",class:"hero-desc"}," 通过自定义时间范围查看订单转化情况，掌握发货、签收效率以及社区居民偏好。 ",-1)),t("p",H," 当前时间段内订单总数 "+s(a.value.total)+"，已支付 "+s(a.value.paid)+"，已送达 "+s(a.value.delivered)+"。 ",1)]),t("div",Q,[e[5]||(e[5]=t("span",{id:"leader-stats-filter-tip",class:"sr-only"},"选择起止时间后会自动刷新统计数据。",-1)),l(p,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=B=>c.value=B),type:"datetimerange","start-placeholder":"开始时间","end-placeholder":"结束时间","unlink-panels":!0,onChange:v,"aria-label":"选择统计时间范围","aria-describedby":"leader-stats-filter-tip"},null,8,["modelValue"]),l(f,{type:"primary",onClick:v,loading:u.value},{default:o(()=>[...e[4]||(e[4]=[n(" 刷新数据 ",-1)])]),_:1},8,["loading"])])]),t("section",R,[e[6]||(e[6]=t("h2",{id:"leader-overview-title",class:"sr-only"},"订单汇总数据",-1)),u.value?(b(),E(r,{key:0,animated:"",rows:4})):(b(),E(x,{key:1,column:3,border:""},{default:o(()=>[l(i,{label:"订单总数"},{default:o(()=>[n(s(a.value.total),1)]),_:1}),l(i,{label:"已支付"},{default:o(()=>[n(s(a.value.paid),1)]),_:1}),l(i,{label:"在途配送"},{default:o(()=>[n(s(a.value.shipped),1)]),_:1}),l(i,{label:"已送达"},{default:o(()=>[n(s(a.value.delivered),1)]),_:1}),l(i,{label:"GMV（总额）"},{default:o(()=>[n("¥ "+s(h(a.value.gmv)),1)]),_:1}),l(i,{label:"完成率"},{default:o(()=>[l(V,{percentage:Math.min(Math.round(a.value.delivered/(a.value.total||1)*100),100),"stroke-width":12,status:"success"},null,8,["percentage"])]),_:1})]),_:1}))]),t("section",T,[t("article",q,[e[7]||(e[7]=t("h3",null,"支付转化率",-1)),t("p",z,s(w.value)+"% ",1),e[8]||(e[8]=t("p",{class:"muted"},"订单支付率反映居民参与热度。",-1))]),t("article",J,[e[9]||(e[9]=t("h3",null,"平均订单金额",-1)),t("p",K,"¥ "+s(S.value),1),e[10]||(e[10]=t("p",{class:"muted"},"衡量社区消费能力与商品结构。",-1))]),t("article",W,[e[11]||(e[11]=t("h3",null,"配送完成时效",-1)),t("p",X,s(D.value)+" 小时",1),e[12]||(e[12]=t("p",{class:"muted"},"从发货到签收的平均耗时。",-1))])])])}}},ye=L(Y,[["__scopeId","data-v-6c6ea873"]]);export{ye as default};
