import{u as O}from"./index-BRtYqat6.js";import{v as T,E as I,a as L}from"./el-table-column-KoNqeqPg.js";import{E as k}from"./el-empty-aBf0dV6S.js";import"./el-checkbox-BY45api5.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-scrollbar-eEMXupeW.js";/* empty css               */import{_ as w,E as x}from"./_plugin-vue_export-helper-BH_is9DS.js";import{d as b}from"./vendor-utils-Bof1u0Bp.js";import{l as B}from"./orders-BKzCgbou.js";import{E as h}from"./http-y0YsLSxU.js";import{E as N}from"./index-B89e1ymx.js";import{r as Y,K as P,p as V,c as H,o as f,a as s,E as i,Q as r,D as p,U as R,B as M,R as S,P as m}from"./vendor-vue-CpX8Jn4o.js";import"./_Uint8Array-CSQzEANR.js";import"./_initCloneObject-CQpWRfh0.js";import"./_baseIteratee-BeonsPYq.js";import"./isEqual-BuOCdSDg.js";import"./castArray-esTnwj7j.js";import"./debounce-Bg3a7BCK.js";import"./vendor-icons-CDwfVtjd.js";import"./index-BquL_2tb.js";import"./index-CkCNIzEM.js";import"./focus-trap-P_RRA6FG.js";import"./typescript-Bp3YSIOJ.js";const $={class:"page-wrap leader-dashboard"},U={class:"page-card dashboard-hero","aria-labelledby":"leader-dashboard-title","aria-describedby":"leader-dashboard-desc"},j={class:"sr-only"},z={class:"page-card",role:"region","aria-labelledby":"leader-stats-title"},F={class:"stat-grid"},K={class:"stat-card"},Q={class:"stat-card__value"},q={class:"stat-card__trend"},G={class:"stat-card"},J={class:"stat-card__value"},W={class:"stat-card"},X={class:"stat-card__value"},Z={class:"stat-card"},tt={class:"stat-card__value"},st={class:"page-card recent-orders","aria-labelledby":"leader-recent-orders-title",role:"region"},et={class:"page-section-title"},at={__name:"LeaderDashboard",setup(rt){const A=O(),c=Y(!1),_=Y([]),e=P({todayOrders:0,todayTrend:0,shipping:0,delivered:0,amount:"0.00"}),g={CREATED:{label:"待支付",type:"warning"},PAID:{label:"待发货",type:"primary"},SHIPPED:{label:"运输中",type:"info"},DELIVERED:{label:"已完成",type:"success"},CANCELLED:{label:"已取消",type:"danger"}},v=d=>(Number(d)||0).toFixed(2);return V(async()=>{var d;c.value=!0;try{const t=await B(A.userId,{page:1,size:20});if(t.code===0){const o=t.list||((d=t.data)==null?void 0:d.list)||[];_.value=o.slice(0,6).map(a=>({...a,createdAt:a.createdAt?b(a.createdAt).format("YYYY-MM-DD HH:mm"):""}));const n=b().format("YYYY-MM-DD"),u=o.filter(a=>b(a.createdAt).format("YYYY-MM-DD")===n);e.todayOrders=u.length,e.todayTrend=Math.max(Math.round(e.todayOrders/(o.length||1)*100),0),e.shipping=o.filter(a=>a.status==="SHIPPED").length,e.delivered=o.filter(a=>a.status==="DELIVERED").length,e.amount=v(o.reduce((a,y)=>a+(y.amount||0),0))}else h.error(t.msg||"加载数据失败")}catch(t){h.error(t.message||"加载失败")}finally{c.value=!1}}),(d,t)=>{const o=x,n=L,u=N,a=I,y=k,C=T;return f(),H("div",$,[s("section",U,[s("div",null,[t[2]||(t[2]=s("span",{class:"pill"},"团长工作台",-1)),t[3]||(t[3]=s("h1",{id:"leader-dashboard-title",class:"hero-title"},"掌握社区团购的每一个节点",-1)),t[4]||(t[4]=s("p",{id:"leader-dashboard-desc",class:"hero-desc"}," 快速查看订单进度、配送情况与经营指标，助力社区居民及时收到新鲜商品。 ",-1)),s("p",j," 当前摘要：今日订单 "+r(e.todayOrders)+" 笔，在途订单 "+r(e.shipping)+" 笔，近 7 日成交额 "+r(e.amount)+" 元。 ",1)]),i(o,{type:"primary",onClick:t[0]||(t[0]=l=>d.$router.push("/leader/orders"))},{default:p(()=>[...t[5]||(t[5]=[m(" 查看全部订单 ",-1)])]),_:1})]),s("section",z,[t[13]||(t[13]=s("h2",{id:"leader-stats-title",class:"sr-only"},"核心指标",-1)),s("div",F,[s("div",K,[t[6]||(t[6]=s("span",{class:"stat-card__title"},"今日订单数",-1)),s("span",Q,r(e.todayOrders),1),s("span",q,"+"+r(e.todayTrend)+"% 较昨日",1)]),s("div",G,[t[7]||(t[7]=s("span",{class:"stat-card__title"},"在途订单",-1)),s("span",J,r(e.shipping),1),t[8]||(t[8]=s("span",{class:"stat-card__trend"},"需要尽快安排配送",-1))]),s("div",W,[t[9]||(t[9]=s("span",{class:"stat-card__title"},"已完成",-1)),s("span",X,r(e.delivered),1),t[10]||(t[10]=s("span",{class:"stat-card__trend"},"累计完成订单",-1))]),s("div",Z,[t[11]||(t[11]=s("span",{class:"stat-card__title"},"近7日成交额",-1)),s("span",tt,"¥ "+r(e.amount),1),t[12]||(t[12]=s("span",{class:"stat-card__trend"},"含配送与自提订单",-1))])])]),s("section",st,[s("header",et,[t[15]||(t[15]=s("h2",{id:"leader-recent-orders-title"},"最新订单",-1)),i(o,{text:"",type:"primary",onClick:t[1]||(t[1]=l=>d.$router.push("/leader/orders"))},{default:p(()=>[...t[14]||(t[14]=[m("更多",-1)])]),_:1})]),R((f(),M(a,{data:_.value,border:"","aria-describedby":"leader-recent-orders-title"},{default:p(()=>[i(n,{prop:"id",label:"订单号",width:"120"}),i(n,{label:"金额",width:"120"},{default:p(({row:l})=>[m("¥ "+r(v(l.amount)),1)]),_:1}),i(n,{label:"状态",width:"140"},{default:p(({row:l})=>{var E;return[i(u,{type:((E=g[l.status])==null?void 0:E.type)||"info"},{default:p(()=>{var D;return[m(r(((D=g[l.status])==null?void 0:D.label)||l.status),1)]}),_:2},1032,["type"])]}),_:1}),i(n,{prop:"createdAt",label:"下单时间"})]),_:1},8,["data"])),[[C,c.value]]),!c.value&&!_.value.length?(f(),M(y,{key:0,description:"暂时没有订单数据"})):S("",!0)])])}}},Lt=w(at,[["__scopeId","data-v-52657a03"]]);export{Lt as default};
