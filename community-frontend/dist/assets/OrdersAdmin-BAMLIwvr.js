import"./index-BRtYqat6.js";import{v as T,E as z,a as O}from"./el-table-column-KoNqeqPg.js";import{a as M}from"./el-select-BS9GzTGv.js";/* empty css               */import"./el-scrollbar-eEMXupeW.js";/* empty css                 */import{E as H}from"./el-empty-aBf0dV6S.js";import"./el-checkbox-BY45api5.js";import"./el-tooltip-l0sNRNKZ.js";import{_ as q,E as F}from"./_plugin-vue_export-helper-BH_is9DS.js";import{E as Q}from"./el-segmented-Wqm1m1L1.js";import{h as $,E as w}from"./http-y0YsLSxU.js";import{E as G}from"./index-B89e1ymx.js";import{r as p,b as J,p as K,c as V,o as f,a,Q as E,E as o,D as u,U as W,B as k,R as x,P as y}from"./vendor-vue-CpX8Jn4o.js";import"./_Uint8Array-CSQzEANR.js";import"./_initCloneObject-CQpWRfh0.js";import"./_baseIteratee-BeonsPYq.js";import"./isEqual-BuOCdSDg.js";import"./castArray-esTnwj7j.js";import"./debounce-Bg3a7BCK.js";import"./vendor-icons-CDwfVtjd.js";import"./index-BquL_2tb.js";import"./index-C9h3pgbl.js";import"./typescript-Bp3YSIOJ.js";import"./scroll-C14GUqjp.js";import"./vnode-D67uqoy8.js";import"./index-CkCNIzEM.js";import"./focus-trap-P_RRA6FG.js";const X={class:"page-wrap admin-orders"},Y={class:"page-card orders-hero","aria-labelledby":"admin-orders-title","aria-describedby":"admin-orders-desc"},Z={class:"sr-only"},ee={class:"hero-actions","aria-label":"过滤与导出"},te={class:"table-card",role:"region","aria-labelledby":"admin-orders-table-title"},ae={class:"table-card__body"},oe={key:1,class:"pagination-bar"},le={__name:"OrdersAdmin",setup(se){const n=p("ALL"),d=p([]),v=p(0),_=p(1),I=p(10),m=p(!1),P=[{label:"全部",value:"ALL"},{label:"待支付",value:"CREATED"},{label:"已支付",value:"PAID"},{label:"在途",value:"SHIPPED"},{label:"已完成",value:"DELIVERED"}],h={CREATED:{label:"待支付",type:"warning"},PAID:{label:"待发货",type:"primary"},SHIPPED:{label:"运输中",type:"info"},DELIVERED:{label:"已完成",type:"success"},CANCELLED:{label:"已取消",type:"danger"}},R=J(()=>n.value==="ALL"?void 0:n.value),S=i=>(Number(i)||0).toFixed(2),c=async()=>{var i,e;m.value=!0;try{const t=await $.get("/orders/all",{params:{status:R.value,page:_.value,size:I.value}});t.code===0?(d.value=t.list||((i=t.data)==null?void 0:i.list)||[],v.value=t.total??((e=t.data)==null?void 0:e.total)??d.value.length):w.error(t.msg||"加载订单失败")}catch(t){w.error(t.message||"加载失败")}finally{m.value=!1}},B=()=>{_.value=1,c()},U=()=>{const i=d.value||[],t=[["订单号","用户ID","团长ID","供应商ID","金额","状态","下单时间"].join(",")];for(const s of i)t.push([s.id,s.userId,s.leaderId,s.supplierId,s.amount,s.status,s.createdAt].map(D=>`"${(D??"").toString().replaceAll('"','""')}"`).join(","));const g=new Blob([t.join(`
`)],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(g),b=document.createElement("a");b.href=l,b.download="orders.csv",b.click(),URL.revokeObjectURL(l)};return K(c),(i,e)=>{var L;const t=Q,g=F,l=O,b=G,s=z,D=H,j=M,N=T;return f(),V("div",X,[a("section",Y,[a("div",null,[e[2]||(e[2]=a("span",{class:"pill"},"订单管理",-1)),e[3]||(e[3]=a("h1",{id:"admin-orders-title",class:"hero-title"},"全平台订单监控",-1)),e[4]||(e[4]=a("p",{id:"admin-orders-desc",class:"hero-desc"}," 支持按状态筛选、导出订单数据，掌握平台订单流转情况。 ",-1)),a("p",Z," 当前筛选状态为 "+E(n.value==="ALL"?"全部":((L=h[n.value])==null?void 0:L.label)||n.value)+"，列表共有 "+E(v.value)+" 笔订单。 ",1)]),a("div",ee,[e[7]||(e[7]=a("span",{id:"admin-orders-filter-tip",class:"sr-only"},"切换状态选项将刷新订单列表。",-1)),o(t,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=r=>n.value=r),options:P,onChange:B,"aria-describedby":"admin-orders-filter-tip"},null,8,["modelValue"]),o(g,{type:"primary",onClick:c,loading:m.value},{default:u(()=>[...e[5]||(e[5]=[y("刷新",-1)])]),_:1},8,["loading"]),o(g,{onClick:U,disabled:!d.value.length},{default:u(()=>[...e[6]||(e[6]=[y("导出 CSV",-1)])]),_:1},8,["disabled"])])]),a("section",te,[e[8]||(e[8]=a("header",{class:"table-card__header table-header"},[a("h2",{id:"admin-orders-table-title",class:"page-section-title"},"订单列表")],-1)),a("div",ae,[W((f(),k(s,{data:d.value,border:"","aria-describedby":"admin-orders-table-title"},{default:u(()=>[o(l,{prop:"id",label:"订单号",width:"120"}),o(l,{prop:"userId",label:"用户ID",width:"120"}),o(l,{prop:"leaderId",label:"团长ID",width:"120"}),o(l,{prop:"supplierId",label:"供应商ID",width:"120"}),o(l,{label:"金额",width:"120"},{default:u(({row:r})=>[y("¥ "+E(S(r.amount)),1)]),_:1}),o(l,{prop:"status",label:"状态",width:"140"},{default:u(({row:r})=>{var C;return[o(b,{type:((C=h[r.status])==null?void 0:C.type)||"info"},{default:u(()=>{var A;return[y(E(((A=h[r.status])==null?void 0:A.label)||r.status),1)]}),_:2},1032,["type"])]}),_:1}),o(l,{prop:"createdAt",label:"下单时间"})]),_:1},8,["data"])),[[N,m.value]]),!m.value&&!d.value.length?(f(),k(D,{key:0,description:"暂无订单数据"})):x("",!0),v.value?(f(),V("div",oe,[o(j,{total:v.value,"current-page":_.value,"onUpdate:currentPage":e[1]||(e[1]=r=>_.value=r),"page-size":I.value,layout:"prev, pager, next, jumper",onCurrentChange:c,onSizeChange:c},null,8,["total","current-page","page-size"])])):x("",!0)])])])}}},Be=q(le,[["__scopeId","data-v-e6666349"]]);export{Be as default};
