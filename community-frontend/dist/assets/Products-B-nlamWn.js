import{u as D}from"./index-BRtYqat6.js";import{v as P,E as S,a as F}from"./el-table-column-KoNqeqPg.js";import{E as T}from"./el-empty-aBf0dV6S.js";import"./el-checkbox-BY45api5.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-scrollbar-eEMXupeW.js";/* empty css               */import{E as M,a as z}from"./el-form-item-DFokbjd4.js";/* empty css                 */import{_ as K,E as L}from"./_plugin-vue_export-helper-BH_is9DS.js";import{l as Q,c as R,b as $}from"./supplier-DrPTNbdy.js";import{E as i}from"./http-y0YsLSxU.js";import{E as j}from"./index-C9h3pgbl.js";import{E as q}from"./index-B89e1ymx.js";import{r as v,K as A,p as G,c as H,o as E,a,E as o,Q as m,D as r,U as J,B as k,R as O,P as n}from"./vendor-vue-CpX8Jn4o.js";import"./_Uint8Array-CSQzEANR.js";import"./_initCloneObject-CQpWRfh0.js";import"./_baseIteratee-BeonsPYq.js";import"./isEqual-BuOCdSDg.js";import"./castArray-esTnwj7j.js";import"./debounce-Bg3a7BCK.js";import"./vendor-icons-CDwfVtjd.js";import"./index-BquL_2tb.js";import"./index-CkCNIzEM.js";import"./focus-trap-P_RRA6FG.js";import"./typescript-Bp3YSIOJ.js";const W={class:"page-wrap supplier-products"},X={class:"page-card products-hero","aria-labelledby":"supplier-products-title","aria-describedby":"supplier-products-desc"},Y={class:"sr-only"},Z={class:"page-card product-form",role:"region","aria-labelledby":"supplier-product-form-title"},ee={class:"table-card",role:"region","aria-labelledby":"supplier-product-table-title"},te={class:"table-card__body"},oe={__name:"Products",setup(le){const b=D(),f=v([]),c=v(!1),g=v(!1),t=A({name:"",categoryId:"",price:"",stock:"",description:""}),I=s=>(Number(s)||0).toFixed(2),w=()=>{t.name="",t.categoryId="",t.price="",t.stock="",t.description=""},_=async()=>{var s;c.value=!0;try{const e=await Q(b.userId,{page:1,size:100});e.code===0?f.value=e.records||((s=e.data)==null?void 0:s.records)||e.list||[]:i.error(e.msg||"商品列表加载失败")}catch(e){i.error(e.message||"加载失败")}finally{c.value=!1}},h=async()=>{if(!t.name||!t.price||!t.stock){i.error("请完善商品名称、价格和库存");return}g.value=!0;try{const s={name:t.name,categoryId:t.categoryId||null,price:Number(t.price),stock:Number(t.stock),description:t.description},e=await R(b.userId,s);e.code===0?(i.success("商品已提交审核"),w(),await _()):i.error(e.msg||"发布失败")}catch(s){i.error(s.message||"发布异常")}finally{g.value=!1}},x=async s=>{try{const e=await $(b.userId,s.id,!s.status);e.code===0?(i.success("商品状态已更新"),await _()):i.error(e.msg||"更新失败")}catch(e){i.error(e.message||"更新失败")}};return G(_),(s,e)=>{const y=L,u=j,p=z,C=M,d=F,V=q,N=S,U=T,B=P;return E(),H("div",W,[a("section",X,[a("div",null,[e[5]||(e[5]=a("span",{class:"pill"},"商品管理",-1)),e[6]||(e[6]=a("h1",{id:"supplier-products-title",class:"hero-title"},"维护供应的商品信息",-1)),e[7]||(e[7]=a("p",{id:"supplier-products-desc",class:"hero-desc"}," 发布新品、调整库存与价格，关注审核状态，确保商品及时上架到社区团购平台。 ",-1)),a("p",Y," 当前共有 "+m(f.value.length)+" 个商品，可在下方填写表单新增，并在列表中执行上下架操作。 ",1)]),o(y,{type:"primary",onClick:_,loading:c.value},{default:r(()=>[...e[8]||(e[8]=[n("刷新数据",-1)])]),_:1},8,["loading"])]),a("section",Z,[e[10]||(e[10]=a("header",{class:"page-section-title"},[a("h2",{id:"supplier-product-form-title"},"发布新商品")],-1)),e[11]||(e[11]=a("p",{id:"supplier-product-form-tip",class:"sr-only"}," 必填项包括商品名称、价格和库存，填写完成后点击发布商品提交审核。 ",-1)),o(C,{model:t,"label-width":"100px",class:"form-grid","aria-describedby":"supplier-product-form-tip"},{default:r(()=>[o(p,{label:"商品名称"},{default:r(()=>[o(u,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.name=l),placeholder:"如：有机蔬菜礼盒"},null,8,["modelValue"])]),_:1}),o(p,{label:"分类 ID"},{default:r(()=>[o(u,{modelValue:t.categoryId,"onUpdate:modelValue":e[1]||(e[1]=l=>t.categoryId=l),placeholder:"数字ID，选填"},null,8,["modelValue"])]),_:1}),o(p,{label:"价格 (元)"},{default:r(()=>[o(u,{modelValue:t.price,"onUpdate:modelValue":e[2]||(e[2]=l=>t.price=l),placeholder:"0.00"},null,8,["modelValue"])]),_:1}),o(p,{label:"库存"},{default:r(()=>[o(u,{modelValue:t.stock,"onUpdate:modelValue":e[3]||(e[3]=l=>t.stock=l),placeholder:"库存数量"},null,8,["modelValue"])]),_:1}),o(p,{label:"描述"},{default:r(()=>[o(u,{modelValue:t.description,"onUpdate:modelValue":e[4]||(e[4]=l=>t.description=l),type:"textarea",rows:"2",placeholder:"简要介绍商品亮点"},null,8,["modelValue"])]),_:1}),o(p,null,{default:r(()=>[o(y,{type:"primary",loading:g.value,onClick:h},{default:r(()=>[...e[9]||(e[9]=[n(" 发布商品 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),a("section",ee,[e[12]||(e[12]=a("header",{class:"table-card__header table-header"},[a("h2",{id:"supplier-product-table-title",class:"page-section-title"},"商品列表")],-1)),a("div",te,[J((E(),k(N,{data:f.value,border:"","aria-describedby":"supplier-product-table-title"},{default:r(()=>[o(d,{prop:"id",label:"ID",width:"80"}),o(d,{prop:"name",label:"名称","min-width":"200"}),o(d,{label:"价格",width:"120"},{default:r(({row:l})=>[n("¥ "+m(I(l.price)),1)]),_:1}),o(d,{prop:"stock",label:"库存",width:"100"}),o(d,{label:"上架状态",width:"140"},{default:r(({row:l})=>[o(V,{type:l.status?"success":"info"},{default:r(()=>[n(m(l.status?"已上架":"已下架"),1)]),_:2},1032,["type"])]),_:1}),o(d,{label:"审核状态",width:"140"},{default:r(({row:l})=>[o(V,{type:l.approved?"success":"warning"},{default:r(()=>[n(m(l.approved?"审核通过":"待审核"),1)]),_:2},1032,["type"])]),_:1}),o(d,{label:"操作",width:"160",align:"center"},{default:r(({row:l})=>[o(y,{link:"",type:"primary",onClick:re=>x(l)},{default:r(()=>[n(m(l.status?"下架":"上架"),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[B,c.value]]),!c.value&&!f.value.length?(E(),k(U,{key:0,description:"暂无商品，请先发布"})):O("",!0)])])])}}},De=K(oe,[["__scopeId","data-v-c10bc009"]]);export{De as default};
