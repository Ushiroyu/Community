import{u as w}from"./index-BRtYqat6.js";import{v as x,E as B,a as C}from"./el-table-column-KoNqeqPg.js";import{E as L}from"./el-empty-aBf0dV6S.js";import"./el-checkbox-BY45api5.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-scrollbar-eEMXupeW.js";/* empty css                 *//* empty css               */import{_ as S,E as I}from"./_plugin-vue_export-helper-BH_is9DS.js";import{p as T,s as U}from"./supplier-DrPTNbdy.js";import{E as i}from"./http-y0YsLSxU.js";import{E as D}from"./index-B89e1ymx.js";import{E as O}from"./index-C9h3pgbl.js";import{r as g,p as M,c as z,o as u,a as r,E as a,D as s,U as F,B as f,R as P,P as p,Q}from"./vendor-vue-CpX8Jn4o.js";import"./_Uint8Array-CSQzEANR.js";import"./_initCloneObject-CQpWRfh0.js";import"./_baseIteratee-BeonsPYq.js";import"./isEqual-BuOCdSDg.js";import"./castArray-esTnwj7j.js";import"./debounce-Bg3a7BCK.js";import"./vendor-icons-CDwfVtjd.js";import"./index-BquL_2tb.js";import"./index-CkCNIzEM.js";import"./focus-trap-P_RRA6FG.js";import"./typescript-Bp3YSIOJ.js";const R={class:"page-wrap supplier-orders"},$={class:"page-card orders-hero","aria-labelledby":"supplier-orders-title","aria-describedby":"supplier-orders-desc"},j={class:"table-card","aria-labelledby":"supplier-orders-table-title",role:"region"},q={class:"table-card__body"},A={__name:"SupplierOrders",setup(G){const b=w(),c=g([]),n=g(!1),h=t=>(Number(t)||0).toFixed(2),m=async()=>{var t;n.value=!0;try{const e=await T(b.userId);if(e.code===0){const d=e.orders||e.list||((t=e.data)==null?void 0:t.list)||[];c.value=d.map(l=>({...l,_trackingNo:"",_shipLoading:!1}))}else i.error(e.msg||"加载待发货订单失败")}catch(e){i.error(e.message||"加载失败")}finally{n.value=!1}},y=async t=>{if(!t._trackingNo){i.warning("请填写物流单号");return}t._shipLoading=!0;try{const e=await U(t.id||t.orderId,t._trackingNo);e.code===0?(i.success("发货成功"),await m()):i.error(e.msg||"发货失败")}catch(e){i.error(e.message||"发货异常")}finally{t._shipLoading=!1}};return M(m),(t,e)=>{const d=I,l=C,v=D,E=O,k=B,N=L,V=x;return u(),z("div",R,[r("section",$,[e[1]||(e[1]=r("div",null,[r("span",{class:"pill"},"订单发货"),r("h1",{id:"supplier-orders-title",class:"hero-title"},"处理社区待发货订单"),r("p",{id:"supplier-orders-desc",class:"hero-desc"}," 填写物流单号后即可确认发货，支持批量刷新数据，确保团长及时收到货品。 "),r("p",{class:"sr-only"}," 列表展示待发货订单，填写物流单号后点击发货即可更新状态。 ")],-1)),a(d,{type:"primary",onClick:m,loading:n.value},{default:s(()=>[...e[0]||(e[0]=[p("刷新列表",-1)])]),_:1},8,["loading"])]),r("section",j,[e[4]||(e[4]=r("header",{class:"table-card__header table-header"},[r("h2",{id:"supplier-orders-table-title",class:"page-section-title"},"待发货订单")],-1)),r("div",q,[F((u(),f(k,{data:c.value,border:"","aria-describedby":"supplier-orders-table-title"},{default:s(()=>[a(l,{prop:"id",label:"订单号",width:"140"}),a(l,{label:"金额",width:"120"},{default:s(({row:o})=>[p("¥ "+Q(h(o.amount)),1)]),_:1}),a(l,{label:"状态",width:"120"},{default:s(({row:o})=>[a(v,{type:"warning"},{default:s(()=>[...e[2]||(e[2]=[p("待发货",-1)])]),_:1})]),_:1}),a(l,{label:"物流单号","min-width":"220"},{default:s(({row:o})=>[a(E,{modelValue:o._trackingNo,"onUpdate:modelValue":_=>o._trackingNo=_,placeholder:"请输入物流单号",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(l,{label:"操作",width:"160",align:"center"},{default:s(({row:o})=>[a(d,{type:"primary",size:"small",onClick:_=>y(o),loading:o._shipLoading},{default:s(()=>[...e[3]||(e[3]=[p(" 发货 ",-1)])]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["data"])),[[V,n.value]]),!n.value&&!c.value.length?(u(),f(N,{key:0,description:"暂无待发货订单"})):P("",!0)])])])}}},he=S(A,[["__scopeId","data-v-705e5e66"]]);export{he as default};
