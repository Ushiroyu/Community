import"./index-BRtYqat6.js";import{E as F,a as G,b as L}from"./el-select-BS9GzTGv.js";/* empty css               */import"./el-scrollbar-eEMXupeW.js";/* empty css                 */import{E as $}from"./el-empty-aBf0dV6S.js";import{E as j}from"./el-skeleton-item-CblNMWFr.js";import{E as q,a as Q}from"./el-radio-group-CAhw3ZdG.js";import{_ as H,E as J,a as W}from"./_plugin-vue_export-helper-BH_is9DS.js";import{r as g,K as X,b as Y,p as Z,c as n,o as r,a as t,E as a,D as i,L as ee,Q as d,B as E,R as V,S,T as z,M as te,u as oe,P as u}from"./vendor-vue-CpX8Jn4o.js";import{s as se}from"./vendor-icons-CDwfVtjd.js";import{l as ae,p as le}from"./products-BcjaDRHQ.js";import{E as re}from"./index-C9h3pgbl.js";import{E as I}from"./http-y0YsLSxU.js";import"./index-B89e1ymx.js";import"./castArray-esTnwj7j.js";import"./isEqual-BuOCdSDg.js";import"./_Uint8Array-CSQzEANR.js";import"./scroll-C14GUqjp.js";import"./debounce-Bg3a7BCK.js";import"./_baseIteratee-BeonsPYq.js";import"./index-BquL_2tb.js";import"./vnode-D67uqoy8.js";import"./typescript-Bp3YSIOJ.js";import"./index-CkCNIzEM.js";import"./focus-trap-P_RRA6FG.js";const ie={class:"page-wrap shop-view"},ne={class:"page-hero","aria-labelledby":"shop-hero-title","aria-describedby":"shop-hero-desc"},de={class:"shop-filters","aria-describedby":"shop-filters-desc"},pe={class:"shop-highlights"},ue={class:"highlight-card"},ce={class:"highlight-value"},me={class:"highlight-card"},ge={class:"highlight-value"},_e={class:"page-card","aria-labelledby":"shop-products-title",role:"region"},he={class:"page-section-title"},ve={key:1},fe={key:0,class:"product-grid"},ye=["onClick"],be={class:"product-card__media"},Ee={key:0,class:"product-tag"},ke={class:"product-thumb"},Ce={class:"product-card__body"},we={class:"product-title"},Ve={class:"product-meta"},Se={class:"product-info"},ze={class:"product-price"},Ie={key:2,class:"pagination-bar"},xe={__name:"Shop",setup(Pe){const x=te(),v=g([]),_=g([]),p=g(1),h=g(0),f=g(!1),l=X({keyword:"",categoryId:null,size:12,sort:"default"}),P=Y(()=>{const o={page:p.value,size:l.size,keyword:l.keyword||void 0,categoryId:l.categoryId||void 0};return l.sort==="priceAsc"&&(o.sort="PRICE_ASC"),l.sort==="priceDesc"&&(o.sort="PRICE_DESC"),l.sort==="stock"&&(o.sort="STOCK_DESC"),o}),c=async()=>{f.value=!0;try{const o=await le(P.value);if(o.code===0||o.success===!0||o.status===200){const e=o.data||o;_.value=e.list||e.records||e.items||e.rows||[],h.value=e.total??e.totalCount??e.count??_.value.length}else I.error(o.msg||o.message||"加载失败")}catch(o){I.error(o.message||"加载异常")}finally{f.value=!1}},B=async()=>{var o;try{const e=await ae();v.value=((o=e.data)==null?void 0:o.categories)||e.categories||e.data||[]}catch(e){console.warn("加载分类失败",e)}},k=()=>{p.value=1,c()},D=()=>{p.value=1,c()},y=()=>{p.value=1,c()},N=o=>{x.push(`/products/${o}`)},R=o=>o?o.slice(0,2).toUpperCase():"GO";return Z(async()=>{await B(),await c()}),(o,e)=>{const U=W,T=re,m=L,C=F,w=J,b=Q,K=q,A=j,M=$,O=G;return r(),n("div",ie,[t("section",ne,[e[9]||(e[9]=t("span",{class:"pill",id:"shop-hero-pill"},"精选团购",-1)),e[10]||(e[10]=t("h1",{id:"shop-hero-title",class:"page-hero__title"},"社区甄选好物 · 新鲜直达每一位邻居",-1)),e[11]||(e[11]=t("p",{class:"page-hero__subtitle",id:"shop-hero-desc"}," 根据社区团长与供应商实时反馈，推荐当季热销与常备民生用品。支持地理位置匹配、库存透明、实时配送跟踪。 ",-1)),e[12]||(e[12]=t("p",{id:"shop-filters-desc",class:"sr-only"}," 可通过关键词、分类以及排序条件筛选商品，回车即可更新列表。 ",-1)),t("div",de,[a(T,{modelValue:l.keyword,"onUpdate:modelValue":e[0]||(e[0]=s=>l.keyword=s),placeholder:"搜索菜品、水果、日用品等",clearable:"",onClear:y,onKeyup:ee(y,["enter","native"])},{prefix:i(()=>[a(U,null,{default:i(()=>[a(oe(se))]),_:1})]),_:1},8,["modelValue"]),a(C,{modelValue:l.categoryId,"onUpdate:modelValue":e[1]||(e[1]=s=>l.categoryId=s),clearable:"",placeholder:"选择分类",onChange:k},{default:i(()=>[(r(!0),n(S,null,z(v.value,s=>(r(),E(m,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(C,{modelValue:l.sort,"onUpdate:modelValue":e[2]||(e[2]=s=>l.sort=s),onChange:k},{default:i(()=>[a(m,{label:"默认排序",value:"default"}),a(m,{label:"价格从低到高",value:"priceAsc"}),a(m,{label:"价格从高到低",value:"priceDesc"}),a(m,{label:"库存优先",value:"stock"})]),_:1},8,["modelValue"]),a(w,{type:"primary",onClick:y},{default:i(()=>[...e[5]||(e[5]=[u("搜索商品",-1)])]),_:1})]),t("div",pe,[t("div",ue,[t("span",ce,d(h.value)+"+",1),e[6]||(e[6]=t("span",{class:"highlight-label"},"可选商品",-1))]),t("div",me,[t("span",ge,d(v.value.length),1),e[7]||(e[7]=t("span",{class:"highlight-label"},"商品分类",-1))]),e[8]||(e[8]=t("div",{class:"highlight-card"},[t("span",{class:"highlight-value"},"即时"),t("span",{class:"highlight-label"},"库存同步")],-1))])]),t("section",_e,[t("header",he,[e[16]||(e[16]=t("h2",{id:"shop-products-title"},"热销商品",-1)),a(K,{modelValue:l.size,"onUpdate:modelValue":e[3]||(e[3]=s=>l.size=s),class:"size-selector",onChange:D},{default:i(()=>[a(b,{label:12},{default:i(()=>[...e[13]||(e[13]=[u("每页 12",-1)])]),_:1}),a(b,{label:24},{default:i(()=>[...e[14]||(e[14]=[u("每页 24",-1)])]),_:1}),a(b,{label:36},{default:i(()=>[...e[15]||(e[15]=[u("每页 36",-1)])]),_:1})]),_:1},8,["modelValue"])]),f.value?(r(),E(A,{key:0,animated:"",rows:6})):(r(),n("div",ve,[_.value.length?(r(),n("div",fe,[(r(!0),n(S,null,z(_.value,s=>(r(),n("article",{key:s.id,class:"product-card",onClick:Be=>N(s.id)},[t("div",be,[s.categoryName?(r(),n("span",Ee,d(s.categoryName),1)):V("",!0),t("div",ke,[t("span",null,d(R(s.name)),1)])]),t("div",Ce,[t("h3",we,d(s.name),1),t("p",Ve,[e[17]||(e[17]=u(" 库存：",-1)),t("strong",null,d(s.stock??0),1)]),t("div",Se,[t("span",ze,"¥ "+d(s.price),1),a(w,{text:"",type:"primary"},{default:i(()=>[...e[18]||(e[18]=[u("查看详情",-1)])]),_:1})])])],8,ye))),128))])):(r(),E(M,{key:1,description:"暂无商品，请调整筛选条件或稍后再试"}))])),h.value?(r(),n("div",Ie,[a(O,{layout:"prev, pager, next, jumper","current-page":p.value,"onUpdate:currentPage":e[4]||(e[4]=s=>p.value=s),"page-size":l.size,total:h.value,onCurrentChange:c},null,8,["current-page","page-size","total"])])):V("",!0)])])}}},at=H(xe,[["__scopeId","data-v-66ce9f13"]]);export{at as default};
